# Log warnings and errors to stderr
log level error;

log to syslog level info;

# Set the interface name
interface "<%= @interface %>";

# Support xsalsa20 and aes128 encryption methods, prefer salsa2012
method "salsa2012+umac";
method "salsa2012+gmac";
<% if @nullcipher == true %>
method "null";
<% else %> 
#method "null"; 
<% end %>
secure handshakes no;

# Bind to a fixed port, IPv4 only
bind 0.0.0.0:<%= @port %>;

# Secret key generated by 'fastd --generate-key'
secret "<%= @fastd_key %>";

# Set the interface MTU for TAP mode with xsalsa20/aes128 over IPv4 with a base MTU of 1492 (PPPoE)
# (see MTU selection documentation)
mtu <%= @mtu %>;
#<%- if not @pmtu.nil? -%>
#<%- @pmtu ? 'yes' : 'no' %>;
#<%- end -%>

# Include peers from the directory 'peers'
peer limit <%= @peerlimit %>;

include peers from "peers";
<% if @backbone %>
include peers from "backbone";
<% else %>
on verify "./verify $PEER_KEY";
<% end %>

on up "./fastd-up";
on down "./fastd-down";
status socket "<%= @socket %>";
#on establish "./on-establish";
#on disestablish "./on-disestablish";

